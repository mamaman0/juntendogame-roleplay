<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uni-Life Balance V2</title>
<style>
  body { font-family: "Helvetica Neue", Arial, sans-serif; background-color: #f0f4f8; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; color: #333; }
  .game-container { background: white; width: 90%; max-width: 600px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); overflow: hidden; display: flex; flex-direction: column; position: relative; min-height: 600px; }
  
  /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
  .header { background-color: #e3f2fd; padding: 10px 15px; border-bottom: 2px solid #bbdefb; display: flex; align-items: center; justify-content: space-between; }
  .player-info { display: flex; align-items: center; gap: 10px; font-weight: bold; color: #1565c0; }
  .player-avatar { font-size: 1.5em; background: #fff; padding: 5px; border-radius: 50%; border: 2px solid #1565c0; }
  
  /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ */
  .status-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px 15px; background: #f1f8ff; }
  .stat-item { font-size: 0.85em; font-weight: bold; }
  .stat-label { margin-bottom: 2px; display: block; display: flex; justify-content: space-between; }
  .progress-bar { background-color: #ddd; height: 10px; border-radius: 5px; width: 100%; overflow: hidden; }
  .progress-fill { height: 100%; width: 50%; transition: width 0.5s ease; }

  /* ã‚­ãƒ£ãƒ©é¸æŠç”»é¢ */
  #start-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 50; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box; }
  .char-select-title { font-size: 1.8em; margin-bottom: 30px; color: #2c3e50; }
  .char-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 30px; }
  .char-card { border: 2px solid #eee; border-radius: 10px; padding: 15px; cursor: pointer; transition: all 0.2s; text-align: center; }
  .char-card:hover, .char-card.selected { border-color: #4a90e2; background: #e3f2fd; transform: translateY(-3px); }
  .char-icon { font-size: 3em; display: block; margin-bottom: 10px; }
  .start-btn { background: #4caf50; color: white; border: none; padding: 15px 40px; font-size: 1.2em; border-radius: 30px; cursor: pointer; font-weight: bold; }

  /* ã‚·ãƒŠãƒªã‚ªç”»é¢ */
  .scene-area { padding: 20px; flex-grow: 1; display: flex; flex-direction: column; align-items: center; text-align: center; }
  .opponent-area { margin-bottom: 15px; animation: float 3s ease-in-out infinite; }
  @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-5px); } 100% { transform: translateY(0px); } }
  .opponent-icon { font-size: 4em; background: #fff3e0; padding: 10px; border-radius: 50%; border: 3px solid #ffb74d; }
  .year-label { color: #888; font-weight: bold; margin-bottom: 5px; text-transform: uppercase; font-size: 0.8em; }
  .scene-title { font-size: 1.4em; margin: 5px 0 15px 0; color: #2c3e50; }
  .scene-text { line-height: 1.8; font-size: 1.05em; text-align: left; background: #fafafa; padding: 15px; border-radius: 10px; width: 100%; box-sizing: border-box; }
  
  /* é¸æŠè‚¢ */
  .choices-area { padding: 20px; background-color: #f9fafb; border-top: 1px solid #eee; display: flex; flex-direction: column; gap: 10px; }
  .btn { background-color: #fff; border: 2px solid #4a90e2; color: #4a90e2; padding: 15px; border-radius: 12px; font-size: 1em; cursor: pointer; transition: all 0.2s; font-weight: bold; }
  .btn:hover { background-color: #4a90e2; color: white; transform: translateY(-2px); }

  /* ãƒ¢ãƒ¼ãƒ€ãƒ« */
  .modal-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: center; z-index: 100; backdrop-filter: blur(2px); }
  .modal-content { background: white; padding: 25px; border-radius: 15px; width: 85%; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); max-height: 90vh; overflow-y: auto; }
  .feedback-title { font-size: 1.3em; margin-bottom: 10px; font-weight: bold; }
  .feedback-text { text-align: left; margin: 15px 0; background: #f0f7ff; padding: 15px; border-radius: 8px; line-height: 1.6; font-size: 0.95em; color: #444; }
  .next-btn { background-color: #ff9800; color: white; border: none; padding: 12px 30px; border-radius: 30px; font-size: 1em; font-weight: bold; cursor: pointer; }
</style>
</head>
<body>

<div class="game-container">
  <div id="start-screen">
    <div class="char-select-title">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠ</div>
    <div class="char-grid">
      <div class="char-card" onclick="selectChar('char1', this)">
        <span class="char-icon">ğŸ§‘â€ğŸ“</span>
        <div>ã¾ã˜ã‚ã‚¿ã‚¤ãƒ—</div>
        <div style="font-size:0.8em;color:#666">çŸ¥è­˜+10</div>
      </div>
      <div class="char-card" onclick="selectChar('char2', this)">
        <span class="char-icon">ğŸƒ</span>
        <div>ã‚¢ã‚¯ãƒ†ã‚£ãƒ–</div>
        <div style="font-size:0.8em;color:#666">ä½“åŠ›+10</div>
      </div>
      <div class="char-card" onclick="selectChar('char3', this)">
        <span class="char-icon">ğŸ˜Œ</span>
        <div>ãŠã£ã¨ã‚Š</div>
        <div style="font-size:0.8em;color:#666">ãƒ¡ãƒ³ã‚¿ãƒ«+10</div>
      </div>
      <div class="char-card" onclick="selectChar('char4', this)">
        <span class="char-icon">ğŸ˜</span>
        <div>ç¤¾äº¤å®¶</div>
        <div style="font-size:0.8em;color:#666">ç¤¾ä¼š+10</div>
      </div>
    </div>
    <button id="start-btn" class="start-btn" onclick="startGame()" disabled>ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
  </div>

  <div class="header">
    <div class="player-info">
      <span id="player-avatar-display" class="player-avatar">ğŸ§‘â€ğŸ“</span>
      <span id="player-type-display">å­¦ç”Ÿ</span>
    </div>
    <div style="font-size:0.9em;color:#666">Uni-Life Balance</div>
  </div>

  <div class="status-grid">
    <div class="stat-item"><div class="stat-label">â¤ï¸ èº«ä½“ <span>Physical</span></div><div class="progress-bar"><div id="bar-physical" class="progress-fill" style="background:#ef5350;"></div></div></div>
    <div class="stat-item"><div class="stat-label">ğŸ§  ãƒ¡ãƒ³ã‚¿ãƒ« <span>Mental</span></div><div class="progress-bar"><div id="bar-mental" class="progress-fill" style="background:#ab47bc;"></div></div></div>
    <div class="stat-item"><div class="stat-label">ğŸ›¡ï¸ çŸ¥è­˜ <span>Literacy</span></div><div class="progress-bar"><div id="bar-literacy" class="progress-fill" style="background:#42a5f5;"></div></div></div>
    <div class="stat-item"><div class="stat-label">ğŸ¤ ç¤¾ä¼š <span>Social</span></div><div class="progress-bar"><div id="bar-social" class="progress-fill" style="background:#66bb6a;"></div></div></div>
  </div>

  <div class="scene-area">
    <div class="opponent-area">
      <div id="opponent-icon" class="opponent-icon">â“</div>
    </div>
    <div id="year-display" class="year-label">LOADING...</div>
    <h2 id="scene-title" class="scene-title"></h2>
    <div id="scene-text" class="scene-text"></div>
  </div>

  <div id="choices-container" class="choices-area"></div>

  <div id="feedback-modal" class="modal-overlay">
    <div class="modal-content">
      <div id="fb-title" class="feedback-title"></div>
      <div id="fb-text" class="feedback-text"></div>
      <button class="next-btn" onclick="nextScenario()">æ¬¡ã¸ â–¶</button>
    </div>
  </div>
</div>

<script>
// --- 1. ã‚·ãƒŠãƒªã‚ªãƒ‡ãƒ¼ã‚¿ (8å•ã«å¢—é‡) ---
const scenarios = [
  {
    year: "1å¹´ç›® æ˜¥", title: "æ–°æ­“ã‚³ãƒ³ãƒ‘", opponent: "ğŸº",
    text: "ã‚µãƒ¼ã‚¯ãƒ«ã®å…ˆè¼©ãŒã‚¸ãƒ§ãƒƒã‚­ã‚’æŒã£ã¦ããŸã€‚ã€Œä¿ºã®é…’ãŒé£²ã‚ãªã„ã®ã‹ï¼ä¸€æ¯ã ã‘ãªã‚‰å¤§ä¸ˆå¤«ã ã‚ï¼Ÿã€",
    choices: [
      { text: "ç©ºæ°—ã‚’èª­ã‚“ã§é£²ã‚€", effects: { physical: -20, social: +5 }, fbTitle: "âš ï¸ å±é™ºä¿¡å·", fbText: "ã€Œä¸€æ¯ã ã‘ã€ãŒä¸€æ°—é£²ã¿ã®å¼•ãé‡‘ã«ãªã‚Šã¾ã™ã€‚çŸ­æ™‚é–“ã®å¤§é‡é£²é…’ï¼ˆãƒ“ãƒ³ã‚¸é£²é…’ï¼‰ã¯æ€¥æ€§ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ä¸­æ¯’ã®ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚" },
      { text: "ã€Œä½“è³ªçš„ã«é£²ã‚ã¾ã›ã‚“ã€", effects: { physical: +10, literacy: +10, social: +5 }, fbTitle: "âœ… ãƒŠã‚¤ã‚¹åˆ¤æ–­ï¼", fbText: "ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒ‘ãƒƒãƒãƒ†ã‚¹ãƒˆç­‰ã§è‡ªåˆ†ã®ä½“è³ªã‚’çŸ¥ã£ã¦ãŠãã“ã¨ã¯å¤§åˆ‡ã§ã™ã€‚å¼·è¦ã¯ã‚¢ãƒ«ãƒãƒ©ï¼ˆãƒãƒ©ã‚¹ãƒ¡ãƒ³ãƒˆï¼‰ã§ã™ã€‚" }
    ]
  },
  {
    year: "1å¹´ç›® å¤", title: "äºˆæœŸã›ã¬å±•é–‹", opponent: "ğŸ˜",
    text: "æ‹äººã¨ã„ã„é›°å›²æ°—ã«ã€‚ã§ã‚‚ã‚³ãƒ³ãƒ‰ãƒ¼ãƒ ãŒãªã„ã€‚ã€Œå¤–ã«å‡ºã›ã°å¤§ä¸ˆå¤«ã ã‚ˆã€ã¨ç›¸æ‰‹ã¯è¨€ã£ã¦ã„ã‚‹ã€‚",
    choices: [
      [cite_start]{ text: "ä¿¡ã˜ã¦å—ã‘å…¥ã‚Œã‚‹", effects: { physical: -30, literacy: -20 }, fbTitle: "âŒ ã‚¹ãƒˆãƒƒãƒ—ï¼", fbText: "å¤–å‡ºã—ï¼ˆè†£å¤–å°„ç²¾ï¼‰ã¯é¿å¦ŠåŠ¹æœãŒä½ãã€æ€§æ„ŸæŸ“ç—‡ã¯å…¨ãé˜²ã’ã¾ã›ã‚“ã€‚ãƒ”ãƒ«ã‚‚æ€§æ„ŸæŸ“ç—‡ã¯äºˆé˜²ã§ãã¾ã›ã‚“ [cite: 79, 76]ã€‚" },
      [cite_start]{ text: "ã€Œä»Šæ—¥ã¯ã‚„ã‚ã¦ãŠã“ã†ã€", effects: { physical: +10, literacy: +20, social: +10 }, fbTitle: "âœ… ç´ æ™´ã‚‰ã—ã„", fbText: "åŒæ„ã¯ã„ã¤ã§ã‚‚æ’¤å›å¯èƒ½ã§ã™ã€‚é¿å¦Šå…·ãŒãªã„å ´åˆã€æ€§è¡Œç‚ºã‚’ã—ãªã„é¸æŠã¯å°Šé‡ã•ã‚Œã‚‹ã¹ãã§ã™ [cite: 20]ã€‚" }
    ]
  },
  {
    year: "2å¹´ç›® æ˜¥", title: "æ€ªã—ã„èª˜ã„", opponent: "ğŸ˜ˆ",
    text: "å‹äººã®çŸ¥äººã‹ã‚‰ã€Œåˆæ³•ãƒãƒ¼ãƒ–ã€ã‚’å‹§ã‚ã‚‰ã‚ŒãŸã€‚ã€Œãƒªãƒ©ãƒƒã‚¯ã‚¹ã§ãã‚‹ã—ã€åˆæ³•ã ã‹ã‚‰æ•ã¾ã‚‰ãªã„ã‚ˆã€",
    choices: [
      { text: "1å›ã ã‘ãªã‚‰â€¦", effects: { physical: -40, mental: -20, literacy: -30 }, fbTitle: "â›” éå¸¸ã«å±é™º", fbText: "ã€Œåˆæ³•ã€ã¨ç§°ã—ã¦ã„ã¦ã‚‚æˆåˆ†ä¸æ˜ã§ã€å‘¼å¸åœæ­¢ã‚„éŒ¯ä¹±ãªã©é‡ç¯¤ãªå¥åº·è¢«å®³ãŒå¤šç™ºã—ã¦ã„ã¾ã™ã€‚1å›ã§ã‚‚ä¾å­˜ã®ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚" },
      { text: "ãã£ã±ã‚Šæ–­ã‚‹", effects: { physical: +10, literacy: +20, social: +5 }, fbTitle: "âœ… æ­£è§£ã§ã™", fbText: "æˆåˆ†ã‚„æ¿ƒåº¦ãŒä¸æ˜ãªè–¬ç‰©ã¯éå¸¸ã«å±é™ºã§ã™ã€‚æ–­ã‚‹å‹‡æ°—ãŒè‡ªåˆ†ã¨æœªæ¥ã‚’å®ˆã‚Šã¾ã™ã€‚" }
    ]
  },
  {
    year: "2å¹´ç›® ç§‹", title: "æ¤œæŸ»ã®ææ¡ˆ", opponent: "ğŸ¥",
    text: "æ–°ã—ã„ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ãŒã§ããŸã€‚ã€Œä»˜ãåˆã†å‰ã«ã€ãŠäº’ã„ã®ãŸã‚ã«æ€§æ„ŸæŸ“ç—‡ã®æ¤œæŸ»ã«è¡Œã‹ãªã„ï¼Ÿã€ã¨ææ¡ˆã•ã‚ŒãŸã€‚",
    choices: [
      [cite_start]{ text: "ã€Œä¿¡é ¼ã—ã¦ãªã„ã®ï¼Ÿã€ã¨æ€’ã‚‹", effects: { social: -20, literacy: -10 }, fbTitle: "ğŸ¤” èª¤è§£ã§ã™", fbText: "æ¤œæŸ»ã®ææ¡ˆã¯ä¿¡é ¼ã—ã¦ã„ãªã„ã‹ã‚‰ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ç„¡ç—‡çŠ¶ã®æ„ŸæŸ“ã‚‚å¤šã„ãŸã‚ã€ãŠäº’ã„ã®å¥åº·ã‚’å®ˆã‚‹ãŸã‚ã®æ„›æƒ…ã‚ã‚‹è¡Œå‹•ã§ã™ [cite: 28]ã€‚" },
      { text: "ä¸€ç·’ã«æ¤œæŸ»ã«è¡Œã", effects: { social: +20, literacy: +20, physical: +10 }, fbTitle: "âœ… ç†æƒ³çš„ãªé–¢ä¿‚", fbText: "ã‚«ãƒƒãƒ—ãƒ«ã§æ¤œæŸ»ã‚’å—ã‘ã‚‹ã“ã¨ã¯ã€æ„ŸæŸ“ãƒªã‚¹ã‚¯ã‚’ä¸‹ã’ã€å®‰å¿ƒã—ã¦é–¢ä¿‚ã‚’ç¯‰ããŸã‚ã®æœ€è‰¯ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã™ã€‚" }
    ]
  },
  {
    year: "3å¹´ç›® æ˜¥", title: "è©¦é¨“å‰ã®ã‚µãƒ—ãƒª", opponent: "ğŸ’Š",
    text: "è©¦é¨“å‹‰å¼·ã§çœ ã„ã€‚SNSã§ã€é›†ä¸­åŠ›ãŒçˆ†ä¸ŠãŒã‚Šã™ã‚‹æµ·å¤–è£½ã‚µãƒ—ãƒªã€ãŒè©±é¡Œã ã€‚",
    choices: [
      { text: "ãƒãƒƒãƒˆã§è³¼å…¥", effects: { physical: -20, mental: -10 }, fbTitle: "âš ï¸ ãƒªã‚¹ã‚¯ã‚ã‚Š", fbText: "ã‚¹ãƒãƒ¼ãƒˆãƒ‰ãƒ©ãƒƒã‚°ç­‰ã®æˆåˆ†ä¸æ˜å“ã¯å‰¯ä½œç”¨ã‚„ä¾å­˜ã®å±é™ºãŒã‚ã‚Šã¾ã™ã€‚å®‰æ˜“ãªå€‹äººè¼¸å…¥ã¯é¿ã‘ã¾ã—ã‚‡ã†ã€‚" },
      [cite_start]{ text: "ç¡çœ ã‚’ã¨ã‚‹", effects: { physical: +10, mental: +10 }, fbTitle: "âœ… æ­£è§£ã§ã™", fbText: "ç¡çœ ä¸è¶³ã¯è¨˜æ†¶ã®å®šç€ã‚’å¦¨ã’ã¾ã™ã€‚ååˆ†ãªç¡çœ ã“ããŒæœ€é«˜ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å¼•ãå‡ºã—ã¾ã™ [cite: 24]ã€‚" }
    ]
  },
  {
    year: "3å¹´ç›® å†¬", title: "ãƒ¡ãƒ³ã‚¿ãƒ«ã®ä¸èª¿", opponent: "â˜ï¸",
    text: "å°±æ´»ãŒã¤ã‚‰ã„ã€‚çœ ã‚Œãšã€é£Ÿæ¬²ã‚‚ãªã„ã€‚ã€Œèª°ã‹ã«ç›¸è«‡ã—ãŸã„ã‘ã©è¿·æƒ‘ã‹ãªâ€¦ã€",
    choices: [
      [cite_start]{ text: "ä¸€äººã§è€ãˆã‚‹", effects: { mental: -30, physical: -10 }, fbTitle: "ğŸ¤• ç„¡ç†ã—ãªã„ã§", fbText: "ã€Œã¤ã‚‰ã„ã€ã¨è¨€ã†ã®ã¯å¼±ã•ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æˆ‘æ…¢ã—ã™ãã‚‹ã¨å›å¾©ã«æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚æ—©æœŸç›¸è«‡ãŒé‡è¦ã§ã™ [cite: 62]ã€‚" },
      { text: "ç›¸è«‡å®¤ã«è¡Œã", effects: { mental: +30, social: +10 }, fbTitle: "âœ… ãã®é€šã‚Š", fbText: "å¤§å­¦ã‚„ä¿å¥æ‰€ã«ã¯å®ˆç§˜ç¾©å‹™ã®ã‚ã‚‹å°‚é–€å®¶ãŒã„ã¾ã™ã€‚ãƒ—ãƒ­ã‚’é ¼ã‚‹ã“ã¨ã¯ç«‹æ´¾ãªã‚¹ã‚­ãƒ«ã§ã™ã€‚" }
    ]
  },
  {
    year: "4å¹´ç›® æ˜¥", title: "ãƒ¯ã‚¯ãƒãƒ³ã®å™‚", opponent: "ğŸ“±",
    text: "SNSã§ã€ŒHPVãƒ¯ã‚¯ãƒãƒ³ã¯å±é™ºã€ä¸å¦Šã«ãªã‚‹ã€ã¨ã„ã†æŠ•ç¨¿ãŒæ‹¡æ•£ã•ã‚Œã¦ã„ã‚‹ã€‚",
    choices: [
      [cite_start]{ text: "å‹é”ã«æ‹¡æ•£ã™ã‚‹", effects: { literacy: -30 }, fbTitle: "âŒ èª¤æƒ…å ±ã§ã™", fbText: "ã€Œä¸å¦Šã«ãªã‚‹ã€ç­‰ã®ä¸»å¼µã«ç§‘å­¦çš„æ ¹æ‹ ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚èª¤æƒ…å ±ã‚’æ‹¡æ•£ã—ãªã„ã‚ˆã†ã€å…¬çš„æ©Ÿé–¢ï¼ˆåšåŠ´çœç­‰ï¼‰ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã† [cite: 82]ã€‚" },
      [cite_start]{ text: "å…¬çš„æƒ…å ±ã‚’ç¢ºèª", effects: { literacy: +30 }, fbTitle: "âœ… ç´ æ™´ã‚‰ã—ã„", fbText: "ä¸å®‰ãªæ™‚ã“ãã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚HPVãƒ¯ã‚¯ãƒãƒ³ã¯å­å®®é ¸ãŒã‚“äºˆé˜²ã«æœ‰åŠ¹ã§ã€å®‰å…¨æ€§ã‚‚ç¢ºèªã•ã‚Œã¦ã„ã¾ã™ [cite: 87]ã€‚" }
    ]
  },
  {
    year: "å’æ¥­", title: "å’æ¥­ãŠã‚ã§ã¨ã†ï¼", opponent: "ğŸ“", text: "4å¹´é–“ã®å¤§å­¦ç”Ÿæ´»ãŒçµ‚ã‚ã‚Šã¾ã—ãŸã€‚ã‚ãªãŸã®é¸æŠã®çµæœã¯â€¦ï¼Ÿ", choices: [], isEnding: true }
];

// --- 2. ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ ---
let currentScenarioIndex = 0;
let selectedCharData = null;
let stats = { physical: 50, mental: 50, literacy: 50, social: 50 };

function selectChar(id, element) {
  // é¸æŠçŠ¶æ…‹ã®è¦‹ãŸç›®å¤‰æ›´
  document.querySelectorAll('.char-card').forEach(c => c.classList.remove('selected'));
  element.classList.add('selected');
  document.getElementById('start-btn').disabled = false;
  
  // ã‚­ãƒ£ãƒ©ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜
  const charMap = {
    'char1': { name: 'ã¾ã˜ã‚ã‚¿ã‚¤ãƒ—', icon: 'ğŸ§‘â€ğŸ“', bonus: { literacy: 10 } },
    'char2': { name: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–', icon: 'ğŸƒ', bonus: { physical: 10 } },
    'char3': { name: 'ãŠã£ã¨ã‚Š', icon: 'ğŸ˜Œ', bonus: { mental: 10 } },
    'char4': { name: 'ç¤¾äº¤å®¶', icon: 'ğŸ˜', bonus: { social: 10 } }
  };
  selectedCharData = charMap[id];
}

function startGame() {
  if(!selectedCharData) return;
  
  // ãƒœãƒ¼ãƒŠã‚¹åæ˜ 
  for(let key in selectedCharData.bonus) {
    stats[key] += selectedCharData.bonus[key];
  }
  
  // ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
  document.getElementById('start-screen').style.display = 'none';
  document.getElementById('player-avatar-display').innerText = selectedCharData.icon;
  document.getElementById('player-type-display').innerText = selectedCharData.name;
  
  updateStatDisplay();
  loadScenario(0);
}

function loadScenario(index) {
  if (index >= scenarios.length) return;
  const scene = scenarios[index];
  const container = document.getElementById('choices-container');
  
  document.getElementById('year-display').innerText = scene.year;
  document.getElementById('scene-title').innerText = scene.title;
  document.getElementById('scene-text').innerText = scene.text;
  
  // ç›¸æ‰‹ã‚¢ã‚¤ã‚³ãƒ³ã®æ›´æ–°
  const opponentIcon = scene.opponent || "â“"; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
  document.getElementById('opponent-icon').innerText = opponentIcon;

  container.innerHTML = '';

  if (scene.isEnding) {
    let finalMsg = "ã‚ãªãŸã®å¥åº·ãƒªãƒ†ãƒ©ã‚·ãƒ¼ã¯ç´ æ™´ã‚‰ã—ã„ã‚‚ã®ã§ã—ãŸï¼";
    if (stats.physical < 30) finalMsg = "å¥åº·é¢ã§å°‘ã—ç„¡ç†ã‚’ã—ã™ããŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚";
    if (stats.literacy > 80) finalMsg = "ãƒ•ã‚¡ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯ã®é”äººã«ãªã‚Œã¾ã—ãŸï¼";
    container.innerHTML = `<div style="padding:20px;background:#e3f2fd;border-radius:10px;"><strong>æˆç¸¾è¡¨:</strong><br>${finalMsg}<br><br><button class="btn" onclick="location.reload()">ã‚‚ã†ä¸€åº¦éŠã¶</button></div>`;
    return;
  }

  scene.choices.forEach((choice, i) => {
    const btn = document.createElement('button');
    btn.className = 'btn';
    btn.innerText = choice.text;
    btn.onclick = () => makeChoice(index, i);
    container.appendChild(btn);
  });
}

function makeChoice(sceneIndex, choiceIndex) {
  const choice = scenarios[sceneIndex].choices[choiceIndex];
  if (choice.effects) {
    for (let key in choice.effects) {
      stats[key] = Math.max(0, Math.min(100, stats[key] + choice.effects[key]));
    }
  }
  updateStatDisplay();
  document.getElementById('fb-title').innerText = choice.fbTitle;
  document.getElementById('fb-text').innerText = choice.fbText;
  document.getElementById('feedback-modal').style.display = 'flex';
}

function nextScenario() {
  document.getElementById('feedback-modal').style.display = 'none';
  currentScenarioIndex++;
  loadScenario(currentScenarioIndex);
}

function updateStatDisplay() {
  document.getElementById('bar-physical').style.width = stats.physical + '%';
  document.getElementById('bar-mental').style.width = stats.mental + '%';
  document.getElementById('bar-literacy').style.width = stats.literacy + '%';
  document.getElementById('bar-social').style.width = stats.social + '%';
}
</script>
</body>
</html>
